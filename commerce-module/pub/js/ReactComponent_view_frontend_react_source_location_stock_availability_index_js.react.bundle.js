"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkmagento_react"] = self["webpackChunkmagento_react"] || []).push([["ReactComponent_view_frontend_react_source_location_stock_availability_index_js"],{

/***/ "../ReactComponent/view/frontend/react_source/location_stock_availability/SourceLocations.js":
/*!***************************************************************************************************!*\
  !*** ../ReactComponent/view/frontend/react_source/location_stock_availability/SourceLocations.js ***!
  \***************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ SourceLocations)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var styled_components__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! styled-components */ \"./node_modules/styled-components/dist/styled-components.browser.esm.js\");\n/* harmony import */ var react_bootstrap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-bootstrap */ \"./node_modules/react-bootstrap/esm/Modal.js\");\n/* harmony import */ var react_bootstrap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-bootstrap */ \"./node_modules/react-bootstrap/esm/Container.js\");\n/* harmony import */ var react_bootstrap__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-bootstrap */ \"./node_modules/react-bootstrap/esm/Row.js\");\n/* harmony import */ var react_bootstrap__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-bootstrap */ \"./node_modules/react-bootstrap/esm/Col.js\");\n/* harmony import */ var react_bootstrap__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-bootstrap */ \"./node_modules/react-bootstrap/esm/InputGroup.js\");\n/* harmony import */ var react_bootstrap__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react-bootstrap */ \"./node_modules/react-bootstrap/esm/Form.js\");\n/* harmony import */ var react_bootstrap__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react-bootstrap */ \"./node_modules/react-bootstrap/esm/ListGroup.js\");\n/* harmony import */ var react_bootstrap__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! react-bootstrap */ \"./node_modules/react-bootstrap/esm/Button.js\");\n\n\n\nclass SourceLocations extends react__WEBPACK_IMPORTED_MODULE_0__.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      items: [],\n      hasError: false,\n      error: \"\",\n      loading: true,\n      selectedSource: \"\"\n    };\n  }\n  getSourceLocations = async searchKey => {\n    const {\n      webhookAccessToken,\n      webhookURL\n    } = this.props;\n    this.setState({\n      loading: true\n    });\n    const data = {\n      data: {\n        searchKey: searchKey\n      }\n    };\n    if (searchKey) {}\n    const request = await fetch(webhookURL + \"ACSourceWebhook\", {\n      method: \"POST\",\n      mode: \"cors\",\n      headers: {\n        Authorization: \"Bearer \" + webhookAccessToken,\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(data)\n    });\n    const result = await request.json();\n    console.log(\"ACSourceWebhook\", result);\n    if (request.status !== 200) {\n      this.setState({\n        items: [],\n        hasError: true,\n        error: JSON.stringify(result),\n        loading: false\n      });\n    } else {\n      if (result.items.length > 0) {\n        const nodes = [];\n        const updatedItems = [];\n        result.items.forEach(element => {\n          if (element.source_code !== \"default\") {\n            nodes.push(element.source_code);\n            updatedItems.push(element);\n          }\n        });\n        await this.getStockDetails(nodes, updatedItems);\n      } else {\n        this.setState({\n          items: [],\n          hasError: false,\n          error: \"\",\n          loading: false\n        });\n      }\n    }\n  };\n  getStockDetails = async (nodes, items) => {\n    const {\n      itemId,\n      lineId,\n      webhookAccessToken,\n      webhookURL,\n      organizationId\n    } = this.props;\n    const data = {\n      data: {\n        items: [{\n          itemId,\n          lineId\n        }]\n      }\n    };\n    console.log(\"getStockDetails\", data);\n    const request = await fetch(webhookURL + \"StockDetailOMS\", {\n      method: \"POST\",\n      headers: {\n        Authorization: \"Bearer \" + webhookAccessToken,\n        \"Content-Type\": \"application/json\",\n        \"x-gw-ims-org-id\": organizationId\n      },\n      body: JSON.stringify(data)\n    });\n    const result = await request.json();\n    console.log(\"StockDetailOMS\", result);\n    if (request.status !== 200) {\n      this.setState({\n        items: [],\n        hasError: true,\n        error: JSON.stringify(result),\n        loading: false\n      });\n    } else {\n      let selectedStore = null;\n      console.log(\"items: \" + JSON.stringify(items));\n      console.log(\"result: \" + JSON.stringify(result));\n      const updatedItems = [];\n      let shipNodeInventory = result.PromiseLines.PromiseLine[0].Availability.AvailableInventory.ShipNodeAvailableInventory;\n      if (shipNodeInventory.Inventory) {\n        if (shipNodeInventory.Inventory.length > 0) {\n          shipNodeInventory.Inventory.forEach(element => {\n            let previousStatus = items.filter(item => {\n              if (item.source_code == element.Node) {\n                return true;\n              }\n            });\n            if (previousStatus.length > 0 && previousStatus[0].source_code === element.Node) {\n              selectedStore = element;\n              if (selectedStore != null) {\n                previousStatus[0][\"availableQuantity\"] = selectedStore.AvailableOnhandQuantity;\n              } else {\n                previousStatus[0][\"availableQuantity\"] = 0;\n              }\n              updatedItems.push(previousStatus[0]);\n            }\n            console.log(\"previousStatus 1:\", JSON.stringify(previousStatus));\n          });\n        } else {\n          let previousStatus = items.filter(item => {\n            if (item.source_code == shipNodeInventory.Inventory.Node) {\n              return true;\n            }\n          });\n          if (previousStatus.length > 0 && previousStatus[0].source_code === shipNodeInventory.Inventory.Node) {\n            selectedStore = shipNodeInventory.Inventory;\n            if (selectedStore != null) {\n              previousStatus[0][\"availableQuantity\"] = selectedStore.AvailableOnhandQuantity;\n            } else {\n              previousStatus[0][\"availableQuantity\"] = 0;\n            }\n            updatedItems.push(previousStatus[0]);\n          }\n        }\n      }\n      console.log(\"updatedItems\", JSON.stringify(updatedItems));\n      // items.forEach((element) => {\n      //   let stockElem = result.PromiseLines.PromiseLine.filter((item) => {\n      //     console.log(\"stockElem Looping...\");\n\n      //     let shipNodeinventory =\n      //       item.Availability.AvailableInventory.ShipNodeAvailableInventory;\n      //     if (shipNodeinventory.Inventory) {\n      //       if (shipNodeinventory.Inventory.length > 0) {\n      //         shipNodeinventory.Inventory.forEach(\n      //           (shipNodeinventoryInventoruy) => {\n      //             if (\n      //               element.source_code === shipNodeinventoryInventoruy.Node\n      //             ) {\n      //               selectedStore = shipNodeinventoryInventoruy;\n      //               return true;\n      //             }\n      //           },\n      //         );\n      //       } else {\n      //         if (element.source_code === shipNodeinventory.Inventory.Node) {\n      //           selectedStore = shipNodeinventory.Inventory;\n      //           return false;\n      //         }\n      //       }\n      //       // if (element.source_code === shipNodeinventory.Inventory.Node) {\n      //       //   return true;\n      //       // }\n      //     }\n      //   });\n      //   console.log(\"selectedStore :\", selectedStore);\n      //   if (selectedStore != null) {\n      //     element[\"availableQuantity\"] = selectedStore.AvailableOnhandQuantity;\n      //   } else {\n      //     element[\"availableQuantity\"] = 0;\n      //   }\n      //   updatedItems.push(element);\n      // });\n      this.setState({\n        items: updatedItems,\n        hasError: false,\n        error: \"\",\n        loading: false\n      });\n    }\n  };\n  async componentDidMount() {\n    await this.getSourceLocations();\n  }\n  searchByPostCode = async e => {\n    if (e.target.value.length > 3) {\n      await this.getSourceLocations(e.target.value);\n    } else if (e.target.value.length == 0) {\n      await this.getSourceLocations(e.target.value);\n    }\n  };\n  getStatus = qty => {\n    if (qty === 0) {\n      return \"No Stock\";\n    } else if (qty < 5) {\n      return \"Low Stock\";\n    }\n    return \"High Stock\";\n  };\n  getStatusColor = qty => {\n    if (qty === 0) {\n      return \"red\";\n    } else if (qty < 5) {\n      return \"orange\";\n    }\n    return \"green\";\n  };\n  setSelectedSource = e => {\n    this.setState({\n      selectedSource: e.target.id\n    });\n  };\n  confirmSource = () => {\n    let selectedSource = this.state.items.filter(item => item.source_code === this.state.selectedSource);\n    this.props.confirmSelectedSource(selectedSource[0]);\n  };\n  render() {\n    const {\n      items,\n      loading,\n      selectedSource\n    } = this.state;\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n      className: \"modal show\",\n      style: {\n        display: \"block\",\n        position: \"initial\"\n      }\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_1__[\"default\"], {\n      size: \"lg\",\n      show: true,\n      onHide: this.props.closeModal\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_1__[\"default\"].Header, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_2__[\"default\"], null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_3__[\"default\"], null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n      md: 5\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_1__[\"default\"].Title, null, \"Source Location Inventory\"), \" \"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_4__[\"default\"], null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_4__[\"default\"], null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n      className: \"mb-3\"\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__[\"default\"].Control, {\n      placeholder: \"Search by Postal Code\",\n      \"aria-label\": \"search\",\n      onChange: this.searchByPostCode\n    })))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_1__[\"default\"].Body, null, loading ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"h6\", null, \" Loading \") : items.length ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_7__[\"default\"], {\n      items: items,\n      selectionMode: \"single\",\n      maxWidth: \"size-6000\",\n      height: \"250px\",\n      \"aria-label\": \"Dynamic ListView items example\",\n      onSelectionChange: this.setSelectedSource\n    }, items.map(item => {\n      let displayAddress = `${item.street ? item.street : \"\"} \n                                        ${item.city ? item.city : \"\"} ${item.region ? item.region : \"\"}\n                                        ${item.country_id ? item.country_id : \"\"} ${item.postcode ? item.postcode : \"\"}`;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_7__[\"default\"].Item, {\n        key: item.name\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n        style: {\n          position: \"relative\",\n          marginLeft: \"25px\"\n        }\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"h5\", null, item.name), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(StockWrapper, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n        className: \"stock-label\",\n        style: {\n          color: this.getStatusColor(parseInt(item.availableQuantity))\n        }\n      }, this.getStatus(parseInt(item.availableQuantity))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"p\", {\n        slot: \"description\"\n      }, displayAddress, \" \"));\n    })) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"h6\", null, \" No Source Location Available \")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_1__[\"default\"].Footer, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_8__[\"default\"], {\n      variant: \"secondary\",\n      onClick: this.props.closeModal\n    }, \"Close\"))));\n  }\n}\nconst StockWrapper = styled_components__WEBPACK_IMPORTED_MODULE_9__[\"default\"].div`\n  .stock-label {\n    position: absolute;\n    right: 20px;\n    fontweight: bolder;\n  }\n`;\n\n//# sourceURL=webpack://magento-react/../ReactComponent/view/frontend/react_source/location_stock_availability/SourceLocations.js?");

/***/ }),

/***/ "../ReactComponent/view/frontend/react_source/location_stock_availability/index.js":
/*!*****************************************************************************************!*\
  !*** ../ReactComponent/view/frontend/react_source/location_stock_availability/index.js ***!
  \*****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ LocationStockStatus)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _SourceLocations__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SourceLocations */ \"../ReactComponent/view/frontend/react_source/location_stock_availability/SourceLocations.js\");\n/* harmony import */ var react_bootstrap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-bootstrap */ \"./node_modules/react-bootstrap/esm/Button.js\");\n\n\n\nclass LocationStockStatus extends react__WEBPACK_IMPORTED_MODULE_0__.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      sourceComponent: false,\n      inStoreComponent: false,\n      selectedSource: {},\n      selectedPickup: {}\n    };\n  }\n  closeModal = () => {\n    this.setState({\n      sourceComponent: false,\n      inStoreComponent: false\n    });\n  };\n  confirmSelectedSource = item => {\n    console.log();\n    this.setState({\n      selectedSource: item,\n      sourceComponent: false\n    });\n  };\n  confirmSelectedPickup = item => {\n    this.setState({\n      selectedPickup: item,\n      inStoreComponent: false\n    });\n  };\n  displayAddress = item => {\n    let displayAdd = `${item.street ? item.street : \"\"} \n            ${item.city ? item.city : \"\"} ${item.region ? item.region : \"\"}\n            ${item.country_id ? item.country_id : \"\"} ${item.postcode ? item.postcode : \"\"}`;\n    return displayAdd;\n  };\n  render() {\n    const {\n      isSourceButtonShow,\n      isInstoreButtonShow,\n      buttonColor,\n      adobeAPIURL,\n      webhookURL,\n      adobeAccessToken,\n      webhookAccessToken,\n      itemId,\n      lineId,\n      organizationId\n    } = this.props;\n    const {\n      sourceComponent,\n      inStoreComponent,\n      selectedSource,\n      selectedPickup\n    } = this.state;\n    console.log(\"this.state\", this.state);\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n      style: {\n        content: \"\",\n        display: \"table\",\n        clear: \"both\",\n        border: 0,\n        borderWidth: 0,\n        borderColor: \"gray\",\n        borderStyle: \"solid\",\n        width: \"100%\"\n      }\n    }, isSourceButtonShow == true && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n      style: {\n        float: \"left\"\n      }\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n      variant: \"link\"\n      // style={{ backgroundColor: buttonColor }}\n      ,\n      type: \"button\",\n      class: \"btn btn-primary\",\n      \"data-toggle\": \"modal\",\n      \"data-target\": \"#exampleModal\",\n      onClick: () => this.setState({\n        sourceComponent: true\n      })\n    }, \"View Source Location Inventory Status\"), selectedSource.source_code && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n      style: {\n        borderStyle: \"solid\",\n        width: \"fit-content\",\n        float: \"right\",\n        padding: \"20px\"\n      }\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"h5\", null, selectedSource.source_code), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"h6\", null, \" \", this.displayAddress(selectedSource)))), isInstoreButtonShow == true && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n      style: {\n        float: \"left\",\n        width: \"15%\",\n        padding: \"10px\"\n      }\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_bootstrap__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n      style: {\n        backgroundColor: buttonColor\n      },\n      onClick: () => this.setState({\n        inStoreComponent: true\n      })\n    }, \"Select In Store Pickup\"), selectedPickup.source_code && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n      style: {\n        borderStyle: \"solid\",\n        width: \"fit-content\",\n        float: \"right\",\n        padding: \"20px\"\n      }\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"h5\", null, selectedPickup.source_code), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"h6\", null, \" \", this.displayAddress(selectedPickup)))), sourceComponent && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_SourceLocations__WEBPACK_IMPORTED_MODULE_1__[\"default\"], {\n      adobeAPIURL: adobeAPIURL,\n      webhookURL: webhookURL,\n      adobeAccessToken: adobeAccessToken,\n      webhookAccessToken: webhookAccessToken,\n      closeModal: this.closeModal,\n      confirmSelectedSource: this.confirmSelectedSource,\n      itemId: itemId,\n      lineId: lineId,\n      organizationId: organizationId\n    }));\n  }\n}\n\n//# sourceURL=webpack://magento-react/../ReactComponent/view/frontend/react_source/location_stock_availability/index.js?");

/***/ })

}]);